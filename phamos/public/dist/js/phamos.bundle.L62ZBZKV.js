(()=>{var d=class{constructor(){this.dialog=null,this.init()}init(){var e=this;function r(a){var t=a.split(":"),s=parseInt(t[0],10)||0,i=parseInt(t[1],10)||0,o=parseInt(t[2],10)||0;return s*3600+i*60+o}frappe.call({method:"phamos.phamos.doctype.have_a_great_day.have_a_great_day.get_user_time",args:{user:frappe.session.user},callback:function(a){if(a.message){var t=a.message.user_time_str||"00:00:00",s=a.message.from_time||"00:00:00",i=a.message.till_time||"23:59:59",o=a.message.enable_feedback_dialog,l=r(t),n=r(s),_=r(i);n<=l&&l<=_&&o==1&&e.showFeedbackDialog()}else console.error("Failed to fetch user time.")},error:function(a){console.error("Error:",a)}})}showFeedbackDialog(){var e=this;let r=frappe.datetime.get_user_date_fmt().toUpperCase(),a=frappe.datetime.get_user_time_fmt();frappe.db.get_value("phamos Settings",{},"is_employee_feedback",function(t){if(t&&t.is_employee_feedback==1)frappe.db.get_value("Employee",{user_id:frappe.session.user},"name",function(i){if(i&&i.name){var o=frappe.datetime.nowdate();frappe.db.get_value("Have a Great Day",{user:frappe.session.user,creation_date:o},"name",function(l){l&&l.name||e.dialog_box()})}});else if(t&&t.is_employee_feedback==0){var s=frappe.datetime.nowdate();frappe.db.get_value("Have a Great Day",{user:frappe.session.user,creation_date:s},"name",function(i){i&&i.name||e.dialog_box()})}})}dialog_box(){this.dialog=new frappe.ui.Dialog({title:__("Have a Great Day!"),fields:[{fieldtype:"Small Text",label:__("What are you most looking forward to today?"),fieldname:"lookingForward",in_list_view:1,reqd:1},{fieldtype:"Column Break"},{fieldtype:"Small Text",label:__("What challenge will you tackle today?"),fieldname:"todaysChallenge",in_list_view:1,reqd:1,default:""}],primary_action_label:__("Save"),primary_action:e=>{this.submit(e),this.dialog.hide()}}),this.dialog.$wrapper.find(".modal-dialog").css("max-width","500px"),this.dialog.show()}submit(e){this.createRecord(e.lookingForward,e.todaysChallenge),this.dialog.hide()}createRecord(e,r){var a=this;frappe.call({method:"phamos.phamos.doctype.have_a_great_day.have_a_great_day.create_todays_feedback",args:{lookingForward:e,todaysChallenge:r},callback:function(t){frappe.msgprint(__("Feedback submitted successfully!"))}})}};$(document).on("app_ready",function(){new d});})();
//# sourceMappingURL=phamos.bundle.L62ZBZKV.js.map
